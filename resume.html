<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resume - Khary A. Mendez</title>
    <meta name="description" content="Printable resume for Khary A. Mendez - Senior Principal Consultant, Red Hat Certified Architect">
    <meta name="robots" content="noindex">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        :root {
            /* Dark Theme Colors (screen) */
            --bg-primary: #0D1B2A;
            --bg-secondary: #1B263B;
            --bg-card: #1a2238;
            --text-primary: #E0E1DD;
            --text-secondary: #778DA9;
            --accent-primary: #00D9FF;
            --accent-secondary: #FFB700;
            --border-color: #2a3550;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', system-ui, -apple-system, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.5;
        }

        /* ========== CONTROLS BAR (hidden in print) ========== */
        .resume-controls {
            position: sticky;
            top: 0;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            padding: 1rem 2rem;
            z-index: 100;
            display: flex;
            flex-wrap: wrap;
            gap: 1.5rem;
            align-items: center;
            justify-content: space-between;
        }

        .controls-left {
            display: flex;
            flex-wrap: wrap;
            gap: 1.5rem;
            align-items: center;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .control-group-label {
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-secondary);
        }

        .toggle-group {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
        }

        .toggle-group label {
            display: flex;
            align-items: center;
            gap: 0.4rem;
            font-size: 0.875rem;
            color: var(--text-primary);
            cursor: pointer;
            padding: 0.4rem 0.75rem;
            background: var(--bg-card);
            border-radius: 6px;
            border: 1px solid var(--border-color);
            transition: all 0.2s ease;
        }

        .toggle-group label:hover {
            border-color: var(--accent-primary);
        }

        .toggle-group input[type="checkbox"] {
            accent-color: var(--accent-primary);
            width: 16px;
            height: 16px;
        }

        .detail-select {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-primary);
            padding: 0.5rem 0.75rem;
            font-size: 0.875rem;
            cursor: pointer;
        }

        .detail-select:focus {
            outline: none;
            border-color: var(--accent-primary);
        }

        .print-btn {
            background: linear-gradient(135deg, var(--accent-primary), #0099cc);
            color: #000;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .print-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 217, 255, 0.3);
        }

        .print-controls {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 0.5rem;
        }

        .print-tip {
            font-size: 0.75rem;
            color: var(--text-secondary);
            max-width: 220px;
            text-align: right;
            line-height: 1.3;
        }

        .back-link {
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.875rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: color 0.2s ease;
        }

        .back-link:hover {
            color: var(--accent-primary);
        }

        /* ========== RESUME CONTENT ========== */
        .resume-wrapper {
            max-width: 850px;
            margin: 0 auto;
            padding: 2rem;
        }

        .resume-content {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 2.5rem;
            border: 1px solid var(--border-color);
        }

        /* Header - compact two-column layout */
        .resume-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding-bottom: 0.75rem;
            border-bottom: 2px solid var(--border-color);
            margin-bottom: 1rem;
            gap: 1rem;
        }

        .resume-header-left {
            flex: 1;
        }

        .resume-name {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--accent-primary);
            margin-bottom: 0.1rem;
            line-height: 1.2;
        }

        .resume-title {
            font-size: 1rem;
            color: var(--text-secondary);
        }

        .resume-header-right {
            text-align: right;
            font-size: 0.85rem;
            color: var(--text-secondary);
            line-height: 1.5;
        }

        .resume-header-right a {
            color: var(--text-secondary);
            text-decoration: none;
            transition: color 0.2s;
        }

        .resume-header-right a:hover {
            color: var(--accent-primary);
        }

        .resume-contact-item {
            display: block;
        }

        /* Sections */
        .resume-section {
            margin-bottom: 1.5rem;
        }

        .resume-section:last-child {
            margin-bottom: 0;
        }

        .resume-section.hidden {
            display: none;
        }

        .section-heading {
            font-size: 1rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--accent-primary);
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--accent-primary);
            margin-bottom: 1rem;
        }

        /* Summary */
        .summary-text {
            color: var(--text-primary);
            font-size: 0.95rem;
            line-height: 1.6;
        }

        /* Experience */
        .work-entry {
            margin-bottom: 1.25rem;
        }

        .work-entry:last-child {
            margin-bottom: 0;
        }

        .work-header {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 0.25rem;
        }

        .work-company {
            font-weight: 600;
            color: var(--text-primary);
            font-size: 1rem;
        }

        .work-dates {
            color: var(--text-secondary);
            font-size: 0.875rem;
        }

        .work-role {
            font-style: italic;
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }

        .work-summary {
            color: var(--text-primary);
            font-size: 0.875rem;
            margin-bottom: 0.5rem;
        }

        .work-highlights {
            list-style: disc;
            margin-left: 1.25rem;
            color: var(--text-primary);
            font-size: 0.875rem;
        }

        .work-highlights li {
            margin-bottom: 0.25rem;
        }

        .work-projects {
            margin-top: 0.75rem;
            padding-left: 1rem;
            border-left: 2px solid var(--border-color);
        }

        .project-entry {
            margin-bottom: 0.75rem;
        }

        .project-entry:last-child {
            margin-bottom: 0;
        }

        .project-header {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .project-name {
            font-weight: 500;
            color: var(--text-primary);
            font-size: 0.875rem;
        }

        .project-dates {
            color: var(--text-secondary);
            font-size: 0.8rem;
        }

        .project-description {
            color: var(--text-secondary);
            font-size: 0.8rem;
            margin-top: 0.25rem;
        }

        .project-bullets {
            list-style: circle;
            margin-left: 1.25rem;
            color: var(--text-primary);
            font-size: 0.8rem;
            margin-top: 0.25rem;
        }

        /* Education */
        .education-entry {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .education-school {
            font-weight: 600;
            color: var(--text-primary);
        }

        .education-degree {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .education-year {
            color: var(--text-secondary);
            font-size: 0.875rem;
        }

        /* Certifications */
        .cert-category {
            margin-bottom: 1rem;
        }

        .cert-category:last-child {
            margin-bottom: 0;
        }

        .cert-category-title {
            font-weight: 600;
            color: var(--text-primary);
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }

        .cert-list {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .cert-tag {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            padding: 0.3rem 0.6rem;
            border-radius: 4px;
            font-size: 0.8rem;
            color: var(--text-primary);
        }

        .cert-tag.featured {
            border-color: var(--accent-secondary);
            background: rgba(255, 183, 0, 0.1);
        }

        /* Skills */
        .skills-category {
            margin-bottom: 0.75rem;
        }

        .skills-category:last-child {
            margin-bottom: 0;
        }

        .skills-label {
            font-weight: 600;
            color: var(--text-secondary);
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 0.25rem;
        }

        .skills-list {
            display: flex;
            flex-wrap: wrap;
            gap: 0.4rem;
        }

        .skill-tag {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.8rem;
            color: var(--text-primary);
        }

        /* Publications */
        .publication-entry {
            margin-bottom: 1rem;
        }

        .publication-entry:last-child {
            margin-bottom: 0;
        }

        .publication-header {
            display: flex;
            flex-wrap: wrap;
            align-items: baseline;
            gap: 0.5rem;
            margin-bottom: 0.25rem;
        }

        .publication-title {
            font-weight: 600;
            color: var(--text-primary);
            font-size: 0.9rem;
        }

        .publication-meta {
            color: var(--text-secondary);
            font-size: 0.8rem;
        }

        .publication-description {
            color: var(--text-secondary);
            font-size: 0.85rem;
            line-height: 1.5;
            margin: 0;
        }

        /* Header website line with note */
        .resume-website-line {
            display: block;
        }

        .resume-contact-note {
            font-size: 0.8rem;
            font-style: italic;
            color: var(--text-secondary);
            opacity: 0.85;
        }

        .resume-website-line a {
            color: var(--accent-primary);
            text-decoration: none;
            font-weight: 500;
        }

        .resume-website-line a:hover {
            text-decoration: underline;
        }

        /* ========== PRINT STYLES ========== */
        @media print {
            /* Page setup - remove browser headers/footers by using margin: 0 */
            @page {
                margin: 0.5in 0.5in 0.6in 0.5in;
                size: letter;
            }

            /* First page can have smaller top margin */
            @page :first {
                margin-top: 0.4in;
            }

            * {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }

            html, body {
                /* Setting margin/padding to manage browser chrome */
                margin: 0 !important;
                padding: 0 !important;
            }

            body {
                background: white !important;
                color: #333 !important;
                font-size: 10pt;
                line-height: 1.4;
            }

            .no-print {
                display: none !important;
            }

            .resume-wrapper {
                max-width: none;
                padding: 0;
                margin: 0;
            }

            .resume-content {
                background: white !important;
                border: none;
                border-radius: 0;
                padding: 0;
            }

            /* Header - preserve two-column layout in print */
            .resume-header {
                display: flex !important;
                flex-direction: row !important;
                justify-content: space-between !important;
                align-items: flex-start !important;
                border-bottom: 2px solid #333;
                padding-bottom: 0.4rem;
                margin-bottom: 0.5rem;
            }

            .resume-header-left {
                flex: 1 1 auto !important;
            }

            .resume-header-right {
                flex: 0 0 auto !important;
                text-align: right !important;
                color: #555 !important;
                font-size: 9pt;
                line-height: 1.4;
            }

            .resume-name {
                color: #1a365d !important;
                font-size: 16pt;
            }

            .resume-title {
                color: #555 !important;
                font-size: 10pt;
            }

            .resume-header-right a {
                color: #1a365d !important;
            }

            /* Sections - allow breaks inside, just keep headings with content */
            .resume-section {
                margin-bottom: 0.6rem;
            }

            /* Section heading wrapper to keep heading with content */
            .section-heading {
                color: #1a365d !important;
                border-color: #1a365d !important;
                font-size: 11pt;
                padding-bottom: 0.25rem;
                margin-bottom: 0.4rem;
                /* Keep heading with following content - use both for browser compat */
                page-break-after: avoid !important;
                break-after: avoid !important;
                page-break-inside: avoid !important;
                break-inside: avoid !important;
            }

            /* Ensure first content after heading stays with it */
            .section-heading + * {
                page-break-before: avoid !important;
                break-before: avoid !important;
            }

            /* Text colors */
            .summary-text,
            .work-company,
            .work-summary,
            .work-highlights,
            .education-school,
            .project-name,
            .project-bullets,
            .cert-category-title,
            .cert-tag,
            .skill-tag,
            .publication-title {
                color: #333 !important;
            }

            .work-role,
            .work-dates,
            .education-degree,
            .education-year,
            .project-dates,
            .project-description,
            .skills-label,
            .publication-meta,
            .publication-description {
                color: #555 !important;
            }

            /* Publications print */
            .publication-entry {
                margin-bottom: 0.6rem;
            }

            .publication-description {
                font-size: 9pt;
                line-height: 1.35;
            }

            /* Header website line */
            .resume-contact-note {
                font-size: 8pt;
                font-style: italic;
                color: #555 !important;
            }

            .resume-website-line a {
                color: #1a365d !important;
                font-weight: 500;
            }

            /* Reduce spacing */
            .work-entry {
                margin-bottom: 0.5rem;
            }

            .work-highlights li {
                margin-bottom: 0.1rem;
            }

            /* Tags */
            .cert-tag,
            .skill-tag {
                background: #f5f5f5 !important;
                border-color: #ddd !important;
            }

            .cert-tag.featured {
                background: #fff8e1 !important;
                border-color: #ffc107 !important;
            }

            .work-projects {
                border-color: #ddd !important;
            }

            /* Smart page break control */
            /* Only avoid breaks inside small elements, not entire sections */
            .work-header,
            .education-entry,
            .cert-category,
            .skills-category,
            .publication-entry {
                page-break-inside: avoid;
                break-inside: avoid;
            }

            /* Keep work entry header with at least some content */
            .work-entry {
                /* Allow breaks inside long work entries */
                page-break-inside: auto;
                break-inside: auto;
            }

            /* But keep the header row together with role */
            .work-header + .work-role {
                page-break-before: avoid;
                break-before: avoid;
            }

            /* Keep project entries together when reasonable */
            .project-entry {
                page-break-inside: avoid;
                break-inside: avoid;
            }

            /* Keep headings with following content */
            h2, h3, .cert-category-title, .skills-label {
                page-break-after: avoid;
                break-after: avoid;
            }

            /* Orphan/widow control */
            p, li {
                orphans: 2;
                widows: 2;
            }

            /* Hide URLs in print but keep text */
            a {
                text-decoration: none !important;
            }

            /* JavaScript-controlled page break for orphaned headings */
            .force-page-break {
                page-break-before: always !important;
                break-before: page !important;
            }

            /* Prevent trailing blank page */
            .resume-content {
                margin-bottom: 0 !important;
                padding-bottom: 0 !important;
            }

            .resume-content > *:last-child {
                margin-bottom: 0 !important;
                padding-bottom: 0 !important;
            }

        }

        /* ========== RESPONSIVE ========== */
        @media (max-width: 768px) {
            .resume-controls {
                flex-direction: column;
                align-items: stretch;
                gap: 1rem;
                padding: 1rem;
            }

            .controls-left {
                flex-direction: column;
                gap: 1rem;
            }

            .toggle-group {
                flex-wrap: wrap;
            }

            .resume-wrapper {
                padding: 1rem;
            }

            .resume-content {
                padding: 1.5rem;
            }

            .resume-header {
                flex-direction: column;
                gap: 0.5rem;
            }

            .resume-header-right {
                text-align: left;
            }

            .resume-name {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <!-- Controls Bar -->
    <div class="resume-controls no-print">
        <div class="controls-left">
            <a href="index.html" class="back-link">
                <span>&larr;</span> Back to Site
            </a>

            <div class="control-group">
                <div class="control-group-label">Sections</div>
                <div class="toggle-group">
                    <label><input type="checkbox" data-section="summary" checked> Summary</label>
                    <label><input type="checkbox" data-section="experience" checked> Experience</label>
                    <label><input type="checkbox" data-section="education" checked> Education</label>
                    <label><input type="checkbox" data-section="certifications" checked> Certifications</label>
                    <label><input type="checkbox" data-section="skills" checked> Skills</label>
                    <label><input type="checkbox" data-section="publications"> Publications</label>
                </div>
            </div>

            <div class="control-group">
                <div class="control-group-label">Experience Detail</div>
                <select id="detail-level" class="detail-select">
                    <option value="full" selected>Full project details</option>
                    <option value="highlights">Key highlights</option>
                    <option value="summary">Summary only</option>
                </select>
            </div>
        </div>

        <div class="print-controls">
            <button onclick="window.print()" class="print-btn">
                <span>Print / Save as PDF</span>
            </button>
            <div class="print-tip">
                Tip: In print dialog, uncheck "Headers and footers" to remove file path and date
            </div>
        </div>
    </div>

    <!-- Resume Content -->
    <div class="resume-wrapper">
        <div class="resume-content" id="resume-content">
            <!-- Content will be rendered by JavaScript -->
        </div>
    </div>

    <!-- Load shared data -->
    <script src="assets/js/resume-data.js"></script>

    <script>
        // ========== RENDER FUNCTIONS ==========

        function renderHeader() {
            const p = RESUME_DATA.personal;
            return `
                <header class="resume-header">
                    <div class="resume-header-left">
                        <h1 class="resume-name">${p.name}</h1>
                        <div class="resume-title">${p.title}</div>
                    </div>
                    <div class="resume-header-right">
                        <span class="resume-contact-item">${p.location}</span>
                        <a href="https://${p.linkedin}" target="_blank" class="resume-contact-item">${p.linkedin}</a>
                        <a href="https://${p.github}" target="_blank" class="resume-contact-item">${p.github}</a>
                        <span class="resume-contact-item resume-website-line">
                            <span class="resume-contact-note">Full details at </span><a href="https://${p.website}" target="_blank">${p.website}</a>
                        </span>
                    </div>
                </header>
            `;
        }

        function renderSummary() {
            return `
                <section class="resume-section" data-section="summary">
                    <h2 class="section-heading">Summary</h2>
                    <p class="summary-text">${RESUME_DATA.personal.tagline} ${RESUME_DATA.metrics.yearsExperience}+ years of experience in software engineering, cloud architecture, and technical leadership. Red Hat Certified Architect with ${RESUME_DATA.metrics.certifications} professional certifications. Proven track record of enabling ${RESUME_DATA.metrics.teamsEnabled}+ teams and delivering enterprise-scale solutions.</p>
                </section>
            `;
        }

        function renderExperience(detailLevel) {
            const experienceHtml = RESUME_DATA.experience.map(job => {
                let content = `
                    <div class="work-entry">
                        <div class="work-header">
                            <span class="work-company">${job.company}</span>
                            <span class="work-dates">${job.dates}</span>
                        </div>
                        <div class="work-role">${job.role}</div>
                `;

                if (detailLevel === 'summary') {
                    content += `<p class="work-summary">${job.summary}</p>`;
                } else if (detailLevel === 'highlights') {
                    content += `
                        <p class="work-summary">${job.summary}</p>
                        <ul class="work-highlights">
                            ${job.highlights.map(h => `<li>${h}</li>`).join('')}
                        </ul>
                    `;
                } else if (detailLevel === 'full') {
                    content += `
                        <p class="work-summary">${job.summary}</p>
                        <div class="work-projects">
                            ${job.projects.map(proj => `
                                <div class="project-entry">
                                    <div class="project-header">
                                        <span class="project-name">${proj.name}</span>
                                        <span class="project-dates">${proj.dates}</span>
                                    </div>
                                    <p class="project-description">${proj.description}</p>
                                    <ul class="project-bullets">
                                        ${proj.bullets.map(b => `<li>${b}</li>`).join('')}
                                    </ul>
                                </div>
                            `).join('')}
                        </div>
                    `;
                }

                content += '</div>';
                return content;
            }).join('');

            return `
                <section class="resume-section" data-section="experience">
                    <h2 class="section-heading">Experience</h2>
                    ${experienceHtml}
                </section>
            `;
        }

        function renderEducation() {
            const eduHtml = RESUME_DATA.education.map(edu => `
                <div class="education-entry">
                    <div>
                        <span class="education-school">${edu.school}</span>
                        <span class="education-degree"> - ${edu.degree}${edu.minor ? `, Minor in ${edu.minor}` : ''}</span>
                    </div>
                    <span class="education-year">${edu.year}</span>
                </div>
            `).join('');

            return `
                <section class="resume-section" data-section="education">
                    <h2 class="section-heading">Education</h2>
                    ${eduHtml}
                </section>
            `;
        }

        function renderCertifications() {
            const categories = [
                { key: 'architect', label: 'Architect Certifications' },
                { key: 'cloud', label: 'Cloud & Professional' },
                { key: 'redhat', label: 'Red Hat Specialist' }
            ];

            const certsHtml = categories.map(cat => {
                const certs = RESUME_DATA.certifications[cat.key];
                return `
                    <div class="cert-category">
                        <div class="cert-category-title">${cat.label}</div>
                        <div class="cert-list">
                            ${certs.map(cert => `
                                <span class="cert-tag${cert.featured ? ' featured' : ''}">${cert.name}</span>
                            `).join('')}
                        </div>
                    </div>
                `;
            }).join('');

            return `
                <section class="resume-section" data-section="certifications">
                    <h2 class="section-heading">Certifications</h2>
                    ${certsHtml}
                </section>
            `;
        }

        function renderSkills() {
            const skillCategories = [
                { key: 'platforms', label: 'Platforms' },
                { key: 'languages', label: 'Languages' },
                { key: 'devops', label: 'DevOps' },
                { key: 'middleware', label: 'Middleware' }
            ];

            const skillsHtml = skillCategories.map(cat => `
                <div class="skills-category">
                    <div class="skills-label">${cat.label}</div>
                    <div class="skills-list">
                        ${RESUME_DATA.skills[cat.key].map(skill => `
                            <span class="skill-tag">${skill}</span>
                        `).join('')}
                    </div>
                </div>
            `).join('');

            return `
                <section class="resume-section" data-section="skills">
                    <h2 class="section-heading">Technical Skills</h2>
                    ${skillsHtml}
                </section>
            `;
        }

        function renderPublications() {
            const pubsHtml = RESUME_DATA.publications.map(pub => `
                <div class="publication-entry">
                    <div class="publication-header">
                        <span class="publication-title">${pub.title}</span>
                        <span class="publication-meta">
                            ${pub.type.charAt(0).toUpperCase() + pub.type.slice(1)}${pub.year ? ` (${pub.year})` : ''}${pub.role ? ` - ${pub.role}` : ''}${pub.publisher ? ` - ${pub.publisher}` : ''}
                        </span>
                    </div>
                    <p class="publication-description">${pub.description}</p>
                </div>
            `).join('');

            return `
                <section class="resume-section hidden" data-section="publications">
                    <h2 class="section-heading">Publications</h2>
                    ${pubsHtml}
                </section>
            `;
        }

        function renderResume(detailLevel = 'full') {
            const container = document.getElementById('resume-content');
            container.innerHTML =
                renderHeader() +
                renderSummary() +
                renderExperience(detailLevel) +
                renderEducation() +
                renderCertifications() +
                renderSkills() +
                renderPublications();

            // Apply current toggle states
            updateSectionVisibility();
        }

        // ========== TOGGLE CONTROLS ==========

        function updateSectionVisibility() {
            const checkboxes = document.querySelectorAll('.toggle-group input[type="checkbox"]');
            checkboxes.forEach(checkbox => {
                const sectionName = checkbox.dataset.section;
                const section = document.querySelector(`.resume-section[data-section="${sectionName}"]`);
                if (section) {
                    section.classList.toggle('hidden', !checkbox.checked);
                }
            });
        }

        // ========== EVENT LISTENERS ==========

        document.addEventListener('DOMContentLoaded', () => {
            // Initial render
            renderResume('full');

            // Section toggle listeners
            document.querySelectorAll('.toggle-group input[type="checkbox"]').forEach(checkbox => {
                checkbox.addEventListener('change', updateSectionVisibility);
            });

            // Detail level listener
            document.getElementById('detail-level').addEventListener('change', (e) => {
                renderResume(e.target.value);
            });

            // Fix orphaned headings before print
            window.addEventListener('beforeprint', () => {
                // Remove any previous forced breaks
                document.querySelectorAll('.force-page-break').forEach(el => {
                    el.classList.remove('force-page-break');
                });

                const content = document.getElementById('resume-content');

                // Page height in pixels (approximate for print layout)
                const pageHeight = 960;
                const minContentAfterHeading = 100;

                // Walk through visible sections
                const elements = content.querySelectorAll('.resume-section:not(.hidden)');

                elements.forEach(el => {
                    const heading = el.querySelector('.section-heading');
                    if (heading) {
                        const headingRect = heading.getBoundingClientRect();
                        const headingBottom = headingRect.bottom - content.getBoundingClientRect().top;

                        // Calculate position within current page
                        const positionInPage = headingBottom % pageHeight;

                        // If heading is near bottom of page, force break before it
                        if (positionInPage > (pageHeight - minContentAfterHeading)) {
                            heading.classList.add('force-page-break');
                        }
                    }
                });
            });

            // Clean up after print
            window.addEventListener('afterprint', () => {
                document.querySelectorAll('.force-page-break').forEach(el => {
                    el.classList.remove('force-page-break');
                });
            });
        });
    </script>
</body>
</html>
